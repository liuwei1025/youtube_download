# YouTube è§†é¢‘ç‰‡æ®µä¸‹è½½å™¨

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ YouTube è§†é¢‘ä¸‹è½½å·¥å…·ï¼Œæ”¯æŒæ—¶é—´æ®µè£å‰ªã€éŸ³é¢‘æå–ã€å­—å¹•ä¸‹è½½ã€‚ç°å·²æ”¯æŒ HTTP API æœåŠ¡ï¼Œå¯éƒ¨ç½²åˆ° Railway.com ç­‰äº‘å¹³å°ã€‚

## ğŸŒŸ ä¸»è¦ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **ç²¾ç¡®æ—¶é—´æ®µè£å‰ª** - ä½¿ç”¨ä¸¤é˜¶æ®µä¸‹è½½ç­–ç•¥ï¼Œå…ˆä¸‹è½½å®Œæ•´è§†é¢‘å†ç²¾ç¡®åˆ‡å‰²
- âœ… **éŸ³é¢‘æå–** - è‡ªåŠ¨æå–éŸ³é¢‘å¹¶ä¿å­˜ä¸ºMP3æ ¼å¼ï¼ˆå¯é…ç½®è´¨é‡ï¼‰
- âœ… **å­—å¹•ä¸‹è½½** - æ”¯æŒå¤šè¯­è¨€å­—å¹•ä¸‹è½½ï¼ˆä¸­/è‹±/æ—¥ç­‰ï¼‰
- âœ… **HTTPä»£ç†æ”¯æŒ** - æ™ºèƒ½ä»£ç†é…ç½®ï¼Œæ”¯æŒç¯å¢ƒå˜é‡å’Œè‡ªå®šä¹‰è®¾ç½®
- âœ… **è§†é¢‘IDç»„ç»‡** - æŒ‰è§†é¢‘IDåˆ›å»ºç›®å½•ï¼Œæ–‡ä»¶ç®¡ç†æ›´æœ‰åº

### æ–°å¢åŠŸèƒ½ (v2.0)
- ğŸ†• **HTTP API æœåŠ¡** - æ”¯æŒ RESTful API è°ƒç”¨ï¼Œå¯äº‘ç«¯éƒ¨ç½²
- ğŸ†• **Railway éƒ¨ç½²æ”¯æŒ** - ä¸€é”®éƒ¨ç½²åˆ° Railway.com
- ğŸ†• **å¼‚æ­¥ä»»åŠ¡å¤„ç†** - åå°å¤„ç†ä¸‹è½½ä»»åŠ¡ï¼Œæ”¯æŒå¹¶å‘
- ğŸ†• **ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢** - å®æ—¶æŸ¥è¯¢ä¸‹è½½è¿›åº¦å’ŒçŠ¶æ€
- ğŸ†• **æ–‡ä»¶ä¸‹è½½æ¥å£** - é€šè¿‡ API ä¸‹è½½å¤„ç†å®Œæˆçš„æ–‡ä»¶
- ğŸ†• **æ‰¹é‡å¤„ç†** - æ”¯æŒä»æ–‡ä»¶è¯»å–å¤šä¸ªURLæ‰¹é‡ä¸‹è½½
- ğŸ†• **é…ç½®æ–‡ä»¶** - æ”¯æŒJSONé…ç½®æ–‡ä»¶ï¼Œä¿å­˜å¸¸ç”¨è®¾ç½®
- ğŸ†• **è¿›åº¦æ¡æ˜¾ç¤º** - æ‰¹é‡å¤„ç†æ—¶æ˜¾ç¤ºå®æ—¶è¿›åº¦
- ğŸ†• **ä¾èµ–æ£€æŸ¥** - è‡ªåŠ¨æ£€æŸ¥å¿…è¦å·¥å…·æ˜¯å¦å®‰è£…
- ğŸ†• **æ—¥å¿—ç³»ç»Ÿ** - å®Œæ•´çš„æ—¥å¿—è®°å½•ï¼Œæ”¯æŒæ–‡ä»¶å’Œæ§åˆ¶å°è¾“å‡º
- ğŸ†• **é”™è¯¯é‡è¯•** - æ™ºèƒ½é‡è¯•æœºåˆ¶ï¼Œæé«˜ä¸‹è½½æˆåŠŸç‡

## ğŸ“¦ å®‰è£…

### ä¾èµ–å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/yourusername/youtube_download.git
cd youtube_download

# å®‰è£… Python ä¾èµ–
pip install -r requirements.txt

# å®‰è£… ffmpeg
# macOS
brew install ffmpeg

# Ubuntu/Debian
sudo apt update && sudo apt install ffmpeg

# Windows
# ä» https://ffmpeg.org/download.html ä¸‹è½½å¹¶æ·»åŠ åˆ° PATH
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ä¸€ï¼šå‘½ä»¤è¡Œå·¥å…·ï¼ˆæœ¬åœ°ä½¿ç”¨ï¼‰

```bash
# åŸºæœ¬ç”¨æ³•
./ytdl "https://www.youtube.com/watch?v=VIDEO_ID" --start 1:00 --end 2:00

# æˆ–ä½¿ç”¨ Python
python src/youtube_downloader.py "https://www.youtube.com/watch?v=VIDEO_ID" \
    --start 1:00 --end 2:00

# æ‰¹é‡ä¸‹è½½
python src/youtube_downloader.py --batch urls.txt --start 1:00 --end 2:00

# ä½¿ç”¨é…ç½®æ–‡ä»¶
python src/youtube_downloader.py URL --start 1:00 --end 2:00 --config config.json
```

**æ›´å¤šå‘½ä»¤è¡Œé€‰é¡¹è¯·æŸ¥çœ‹ï¼š** [docs/README.md](docs/README.md)

### æ–¹å¼äºŒï¼šHTTP API æœåŠ¡ï¼ˆäº‘ç«¯éƒ¨ç½²ï¼‰

#### æœ¬åœ°è¿è¡Œ API æœåŠ¡

```bash
# å¯åŠ¨æœåŠ¡
python app.py

# æœåŠ¡å°†åœ¨ http://localhost:8000 è¿è¡Œ
# è®¿é—® http://localhost:8000/docs æŸ¥çœ‹ API æ–‡æ¡£
```

#### API ä½¿ç”¨ç¤ºä¾‹

```bash
# 1. åˆ›å»ºä¸‹è½½ä»»åŠ¡
curl -X POST "http://localhost:8000/download" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://www.youtube.com/watch?v=VIDEO_ID",
    "start_time": "1:00",
    "end_time": "2:00",
    "download_video": true,
    "download_audio": true
  }'

# å“åº”ç¤ºä¾‹ï¼š
# {
#   "task_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
#   "status": "pending",
#   "message": "ä»»åŠ¡å·²åˆ›å»ºï¼Œæ­£åœ¨å¤„ç†ä¸­"
# }

# 2. æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
curl "http://localhost:8000/tasks/TASK_ID"

# 3. ä¸‹è½½å®Œæˆçš„æ–‡ä»¶
curl -O "http://localhost:8000/tasks/TASK_ID/files/video"
curl -O "http://localhost:8000/tasks/TASK_ID/files/audio"
```

#### æµ‹è¯• API

```bash
# å¿«é€Ÿæµ‹è¯•
python test_api.py --quick

# å®Œæ•´æµ‹è¯•ï¼ˆåŒ…å«ä¸‹è½½ï¼‰
python test_api.py

# æµ‹è¯•è¿œç¨‹æœåŠ¡
python test_api.py --url https://your-app.up.railway.app
```

**æ›´å¤š API è¯¦æƒ…è¯·æŸ¥çœ‹ï¼š** [docs/API_REFERENCE.md](docs/API_REFERENCE.md)

## â˜ï¸ äº‘ç«¯éƒ¨ç½²

### éƒ¨ç½²åˆ° Railway.com

Railway æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„äº‘å¹³å°ï¼Œæ”¯æŒä¸€é”®éƒ¨ç½²ã€‚

#### å¿«é€Ÿéƒ¨ç½²

1. **Fork æœ¬ä»“åº“åˆ°ä½ çš„ GitHub**

2. **è®¿é—® [Railway.com](https://railway.com/) å¹¶ç™»å½•**

3. **åˆ›å»ºæ–°é¡¹ç›®**
   - ç‚¹å‡» "New Project"
   - é€‰æ‹© "Deploy from GitHub repo"
   - é€‰æ‹©ä½  fork çš„ä»“åº“

4. **ç­‰å¾…éƒ¨ç½²å®Œæˆ**
   - Railway ä¼šè‡ªåŠ¨æ£€æµ‹ Dockerfile
   - æ„å»ºå’Œéƒ¨ç½²å¤§çº¦éœ€è¦ 2-5 åˆ†é’Ÿ

5. **ç”Ÿæˆå…¬å¼€åŸŸå**
   - åœ¨æœåŠ¡è®¾ç½®ä¸­ç‚¹å‡» "Generate Domain"
   - è·å¾—ç±»ä¼¼ `your-app.up.railway.app` çš„åŸŸå

6. **å¼€å§‹ä½¿ç”¨**
   ```bash
   # è®¿é—® API æ–‡æ¡£
   https://your-app.up.railway.app/docs
   
   # åˆ›å»ºä¸‹è½½ä»»åŠ¡
   curl -X POST "https://your-app.up.railway.app/download" \
     -H "Content-Type: application/json" \
     -d '{"url": "...", "start_time": "1:00", "end_time": "2:00"}'
   ```

**è¯¦ç»†éƒ¨ç½²æŒ‡å—ï¼š** [docs/DEPLOYMENT.md](docs/DEPLOYMENT.md)

### å…¶ä»–éƒ¨ç½²é€‰é¡¹

æœ¬é¡¹ç›®ä¹Ÿå¯ä»¥éƒ¨ç½²åˆ°ä»¥ä¸‹å¹³å°ï¼š
- **Heroku** - æ”¯æŒ Dockerfile
- **Google Cloud Run** - æ— æœåŠ¡å™¨å®¹å™¨
- **AWS ECS/Fargate** - å®¹å™¨æœåŠ¡
- **DigitalOcean App Platform** - åº”ç”¨å¹³å°
- **Render** - ç±»ä¼¼ Railway çš„å¹³å°

## ğŸ“– æ–‡æ¡£

- [å®Œæ•´ä½¿ç”¨æŒ‡å—](docs/README.md) - å‘½ä»¤è¡Œå·¥å…·è¯¦ç»†è¯´æ˜
- [API å‚è€ƒæ–‡æ¡£](docs/API_REFERENCE.md) - HTTP API å®Œæ•´æ–‡æ¡£
- [Railway éƒ¨ç½²æŒ‡å—](docs/DEPLOYMENT.md) - äº‘ç«¯éƒ¨ç½²æ•™ç¨‹
- [Cookie è®¾ç½®](docs/COOKIES_SETUP.md) - Chrome Cookie é…ç½®
- [é¡¹ç›®ç»“æ„](docs/PROJECT_STRUCTURE.md) - ä»£ç ç»“æ„è¯´æ˜

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ä¸€ï¼šæœ¬åœ°å¿«é€Ÿä¸‹è½½
é€‚åˆä¸ªäººä½¿ç”¨ï¼Œç›´æ¥åœ¨æœ¬åœ°è¿è¡Œå‘½ä»¤è¡Œå·¥å…·ã€‚

```bash
./ytdl "https://www.youtube.com/watch?v=..." --start 1:00 --end 2:00
```

### åœºæ™¯äºŒï¼šWeb åº”ç”¨é›†æˆ
å°† API éƒ¨ç½²åˆ°äº‘ç«¯ï¼Œåœ¨ Web åº”ç”¨ä¸­é›†æˆè§†é¢‘ä¸‹è½½åŠŸèƒ½ã€‚

```javascript
// å‰ç«¯è°ƒç”¨ API
const response = await fetch('https://your-app.up.railway.app/download', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    url: videoUrl,
    start_time: startTime,
    end_time: endTime
  })
});
const { task_id } = await response.json();
```

### åœºæ™¯ä¸‰ï¼šè‡ªåŠ¨åŒ–å·¥ä½œæµ
åœ¨è‡ªåŠ¨åŒ–è„šæœ¬ä¸­ä½¿ç”¨ APIï¼Œæ‰¹é‡å¤„ç†è§†é¢‘ã€‚

```python
import requests

# æ‰¹é‡ä¸‹è½½
for video_url in video_urls:
    response = requests.post(
        'https://your-app.up.railway.app/download',
        json={'url': video_url, 'start_time': '0:00', 'end_time': '1:00'}
    )
    task_id = response.json()['task_id']
    print(f"ä»»åŠ¡åˆ›å»º: {task_id}")
```

## ğŸ”§ é…ç½®

### é…ç½®æ–‡ä»¶ç¤ºä¾‹ (config.json)

```json
{
  "proxy": "http://127.0.0.1:7890",
  "subtitle_langs": "zh,en,ja",
  "video_quality": "best[height<=720]",
  "audio_quality": "256K",
  "max_retries": 5,
  "output_dir": "downloads"
}
```

### ç¯å¢ƒå˜é‡

```bash
# API æœåŠ¡
export PORT=8000
export HOST=0.0.0.0
export DOWNLOADS_DIR=/tmp/downloads

# ä»£ç†è®¾ç½®
export HTTP_PROXY=http://127.0.0.1:7890
export HTTPS_PROXY=http://127.0.0.1:7890
```

## ğŸ“Š æ¶æ„

```
youtube_download/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ youtube_downloader.py  # æ ¸å¿ƒä¸‹è½½é€»è¾‘
â”œâ”€â”€ app.py                      # FastAPI HTTP æœåŠ¡
â”œâ”€â”€ test_api.py                 # API æµ‹è¯•è„šæœ¬
â”œâ”€â”€ Dockerfile                  # Docker é•œåƒé…ç½®
â”œâ”€â”€ railway.json                # Railway éƒ¨ç½²é…ç½®
â”œâ”€â”€ requirements.txt            # Python ä¾èµ–
â”œâ”€â”€ config.json                 # é…ç½®æ–‡ä»¶
â””â”€â”€ docs/                       # æ–‡æ¡£ç›®å½•
    â”œâ”€â”€ README.md               # ä½¿ç”¨æŒ‡å—
    â”œâ”€â”€ API_REFERENCE.md        # API æ–‡æ¡£
    â”œâ”€â”€ DEPLOYMENT.md           # éƒ¨ç½²æŒ‡å—
    â””â”€â”€ COOKIES_SETUP.md        # Cookie è®¾ç½®
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¾èµ–è¦æ±‚**
   - Python 3.8+
   - ffmpeg
   - yt-dlp

2. **ä»£ç†è®¾ç½®**
   - æŸäº›åœ°åŒºå¯èƒ½éœ€è¦ä»£ç†è®¿é—® YouTube
   - å¯é€šè¿‡å‚æ•°ã€é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡è®¾ç½®

3. **Cookie è¦æ±‚**
   - YouTube å¯èƒ½éœ€è¦ Cookie éªŒè¯
   - æ”¯æŒä» Chrome æµè§ˆå™¨å¯¼å…¥ Cookie

4. **å­˜å‚¨ç©ºé—´**
   - Railway ç­‰å¹³å°ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿ
   - æ–‡ä»¶ä¼šåœ¨æœåŠ¡é‡å¯åä¸¢å¤±
   - å»ºè®®åŠæ—¶ä¸‹è½½å®Œæˆçš„æ–‡ä»¶

5. **èµ„æºé™åˆ¶**
   - å…è´¹å¥—é¤æœ‰èµ„æºé™åˆ¶
   - å»ºè®®ä¸‹è½½è¾ƒçŸ­çš„è§†é¢‘ç‰‡æ®µ
   - æ³¨æ„å¹¶å‘ä»»åŠ¡æ•°é‡

6. **ç‰ˆæƒé—®é¢˜**
   - è¯·éµå®ˆ YouTube ä½¿ç”¨æ¡æ¬¾
   - ä»…ç”¨äºä¸ªäººå­¦ä¹ å’Œç ”ç©¶
   - ä¸è¦ç”¨äºå•†ä¸šç”¨é€”

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License - è¯·è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹

## ğŸ”— ç›¸å…³é“¾æ¥

- [yt-dlp](https://github.com/yt-dlp/yt-dlp) - YouTube ä¸‹è½½å·¥å…·
- [FFmpeg](https://ffmpeg.org/) - è§†é¢‘å¤„ç†å·¥å…·
- [FastAPI](https://fastapi.tiangolo.com/) - Web æ¡†æ¶
- [Railway](https://railway.com/) - éƒ¨ç½²å¹³å°

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0.0 (2025-10-07)
- ğŸ†• æ·»åŠ  HTTP API æœåŠ¡
- ğŸ†• æ”¯æŒ Railway ä¸€é”®éƒ¨ç½²
- ğŸ†• å¼‚æ­¥ä»»åŠ¡å¤„ç†
- ğŸ†• æ–‡ä»¶ä¸‹è½½æ¥å£
- ğŸ“– å®Œå–„æ–‡æ¡£å’Œéƒ¨ç½²æŒ‡å—

### v1.2.0
- ğŸ†• æ‰¹é‡å¤„ç†æ”¯æŒ
- ğŸ†• é…ç½®æ–‡ä»¶æ”¯æŒ
- ğŸ”§ æ”¹è¿›é”™è¯¯å¤„ç†

### v1.0.0
- ğŸ‰ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… åŸºæœ¬ä¸‹è½½åŠŸèƒ½
- âœ… æ—¶é—´æ®µè£å‰ª
- âœ… éŸ³é¢‘æå–
- âœ… å­—å¹•ä¸‹è½½

---

**Star â­ æœ¬é¡¹ç›®å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼**
