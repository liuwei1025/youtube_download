# Cookies å·¥å…·å®Œæ•´ä½¿ç”¨æŒ‡å—

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### æµ‹è¯•å½“å‰ Cookies æ˜¯å¦æœ‰æ•ˆ

```bash
./scripts/test_cookies.sh
```

### æ›´æ–° Cookies

```bash
./scripts/update_cookies.sh
```

---

## ğŸ“‹ å·¥å…·è¯´æ˜

### 1. `test_cookies.sh` - Cookies æµ‹è¯•å·¥å…·

**åŠŸèƒ½**ï¼š
- âœ… æ£€æŸ¥ cookies æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- âœ… éªŒè¯æ–‡ä»¶æ ¼å¼
- âœ… æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯ï¼ˆå¤§å°ã€ä¿®æ”¹æ—¶é—´ã€cookie æ•°é‡ï¼‰
- âœ… å®é™…æµ‹è¯•ä¸‹è½½åŠŸèƒ½

**ä½¿ç”¨åœºæ™¯**ï¼š
- é‡åˆ°ä¸‹è½½é”™è¯¯æ—¶ï¼Œå…ˆè¿è¡Œæ­¤å·¥å…·ç¡®è®¤ cookies æ˜¯å¦æœ‰æ•ˆ
- å®šæœŸæ£€æŸ¥ cookies çŠ¶æ€
- æ›´æ–° cookies åéªŒè¯æ˜¯å¦æˆåŠŸ

**ç¤ºä¾‹è¾“å‡º**ï¼š
```bash
$ ./scripts/test_cookies.sh

ğŸ§ª YouTube Cookies æµ‹è¯•å·¥å…·
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“„ æ£€æŸ¥æ–‡ä»¶æ ¼å¼...
âœ… æ–‡ä»¶æ ¼å¼æ­£ç¡®

ğŸ“Š æ–‡ä»¶ä¿¡æ¯:
   è·¯å¾„: /Users/liuwei/Github/youtube/cookies/Cookies
   å¤§å°: 2736 å­—èŠ‚
   ä¿®æ”¹æ—¶é—´: 2025-10-28 22:28:14
   Cookie æ•°é‡: 23

ğŸ³ æ£€æŸ¥ Docker æœåŠ¡...

ğŸ§ª æµ‹è¯• Cookies æœ‰æ•ˆæ€§...
   æµ‹è¯•è§†é¢‘: https://www.youtube.com/watch?v=jNQXAC9IVRw

âœ… Cookies éªŒè¯æˆåŠŸï¼

ğŸ“º æµ‹è¯•ç»“æœ:
Learn Italian with Lucrezia

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‰ æµ‹è¯•å®Œæˆï¼Cookies å·¥ä½œæ­£å¸¸
```

---

### 2. `update_cookies.sh` - Cookies æ›´æ–°å·¥å…·

**åŠŸèƒ½**ï¼š
- âœ… è‡ªåŠ¨å¤‡ä»½æ—§ cookies
- âœ… æ™ºèƒ½æ£€æµ‹æœ€è¿‘æ›´æ–°çš„æ–‡ä»¶
- âœ… éªŒè¯æ–‡ä»¶æ ¼å¼
- âœ… æµ‹è¯•æ–° cookies æ˜¯å¦æœ‰æ•ˆ
- âœ… è‡ªåŠ¨é‡å¯ Docker æœåŠ¡

**ä½¿ç”¨åœºæ™¯**ï¼š
- å‡ºç° "Sign in to confirm you're not a bot" é”™è¯¯
- Cookies è¿‡æœŸéœ€è¦æ›´æ–°
- å®šæœŸç»´æŠ¤ï¼ˆå»ºè®®æ¯æœˆä¸€æ¬¡ï¼‰

**ä¸¤ç§æ›´æ–°æ–¹å¼**ï¼š

#### æ–¹å¼ 1ï¼šç›´æ¥è¦†ç›–ï¼ˆæ¨èï¼‰

1. ä½¿ç”¨æµè§ˆå™¨æ‰©å±•å¯¼å‡º cookies æ—¶ï¼Œç›´æ¥ä¿å­˜ä¸ºï¼š
   ```
   /Users/liuwei/Github/youtube/cookies/Cookies
   ```

2. è¿è¡Œæ›´æ–°è„šæœ¬ï¼š
   ```bash
   ./scripts/update_cookies.sh
   ```

3. é€‰æ‹© **é€‰é¡¹ 1**

#### æ–¹å¼ 2ï¼šä»å…¶ä»–ä½ç½®å¤åˆ¶

1. å°† cookies å¯¼å‡ºåˆ°ä¸‹è½½æ–‡ä»¶å¤¹
2. è¿è¡Œæ›´æ–°è„šæœ¬
3. é€‰æ‹© **é€‰é¡¹ 2**ï¼Œç„¶åè¾“å…¥æ–‡ä»¶è·¯å¾„

**ç¤ºä¾‹æµç¨‹**ï¼š
```bash
$ ./scripts/update_cookies.sh

ğŸ”§ YouTube Cookies æ›´æ–°å·¥å…·
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ å‘ç°ç°æœ‰ cookies æ–‡ä»¶
   ä½ç½®: /Users/liuwei/Github/youtube/cookies/Cookies
âœ… å·²å¤‡ä»½åˆ°: /Users/liuwei/Github/youtube/cookies/Cookies.backup.20251028_220000

ğŸ“‹ è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

1ï¸âƒ£  å®‰è£…æµè§ˆå™¨æ‰©å±•ï¼ˆé€‰æ‹©å…¶ä¸­ä¸€ä¸ªï¼‰ï¼š
   â€¢ Chrome/Edge: 'Get cookies.txt LOCALLY'
   â€¢ Firefox: 'cookies.txt'

2ï¸âƒ£  åœ¨æµè§ˆå™¨ä¸­ï¼š
   â€¢ è®¿é—® https://www.youtube.com
   â€¢ ç¡®ä¿å·²ç™»å½•æ‚¨çš„è´¦æˆ·
   â€¢ ç‚¹å‡»æ‰©å±•å›¾æ ‡
   â€¢ å¯¼å‡º cookiesï¼ˆé€‰æ‹© Netscape æ ¼å¼ï¼‰

3ï¸âƒ£  ä¿å­˜æ–‡ä»¶ï¼š
   â€¢ ç›´æ¥ä¿å­˜åˆ°: /Users/liuwei/Github/youtube/cookies/Cookies
   â€¢ æˆ–ä¿å­˜åˆ°ä¸‹è½½æ–‡ä»¶å¤¹ï¼Œç¨åæŒ‡å®šè·¯å¾„

âœ… æ£€æµ‹åˆ° cookies æ–‡ä»¶åˆšåˆšæ›´æ–°ï¼ˆ5ç§’å‰ï¼‰
æ˜¯å¦ä½¿ç”¨æ­¤æ–‡ä»¶ï¼Ÿ(Y/n): y

âœ… ä½¿ç”¨å½“å‰ Cookies æ–‡ä»¶

ğŸ§ª æµ‹è¯• cookies æ˜¯å¦æœ‰æ•ˆ...
âœ… Cookies éªŒè¯æˆåŠŸï¼

ğŸ”„ æ˜¯å¦é‡å¯ Docker æœåŠ¡ä»¥åº”ç”¨æ›´æ”¹ï¼Ÿ(Y/n): y
ğŸ”„ é‡å¯æœåŠ¡ä¸­...
âœ… æœåŠ¡å·²é‡å¯

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‰ Cookies æ›´æ–°å®Œæˆï¼
```

---

## ğŸ”§ å¸¸è§é”™è¯¯å¤„ç†

### é”™è¯¯ 1: "Sign in to confirm you're not a bot"

**åŸå› **ï¼šCookies å·²å¤±æ•ˆæˆ–æœªé…ç½®

**è§£å†³**ï¼š
```bash
./scripts/update_cookies.sh
```

### é”™è¯¯ 2: "HTTP Error 429: Too Many Requests"

**åŸå› **ï¼šè¯·æ±‚é¢‘ç‡è¿‡é«˜

**è§£å†³**ï¼š
1. ç­‰å¾… 15-30 åˆ†é’Ÿ
2. ç„¶åé‡è¯•ä¸‹è½½

### é”™è¯¯ 3: Cookies éªŒè¯å¤±è´¥

**åŸå› **ï¼š
- æœªåœ¨æµè§ˆå™¨ä¸­ç™»å½• YouTube
- Cookies æ–‡ä»¶æ ¼å¼é”™è¯¯
- Cookies å·²è¿‡æœŸ

**è§£å†³**ï¼š
1. ç¡®ä¿æµè§ˆå™¨ä¸­å·²ç™»å½• YouTube
2. é‡æ–°å¯¼å‡º cookiesï¼ˆä½¿ç”¨æ­£ç¡®çš„æ‰©å±•ï¼‰
3. å†æ¬¡è¿è¡Œæ›´æ–°è„šæœ¬

---

## ğŸ“‚ æ–‡ä»¶ä½ç½®

### Cookies æ–‡ä»¶
```
/Users/liuwei/Github/youtube/cookies/Cookies
```

### å¤‡ä»½æ–‡ä»¶
```
/Users/liuwei/Github/youtube/cookies/Cookies.backup.YYYYMMDD_HHMMSS
```

å¯ä»¥å®šæœŸæ¸…ç†æ—§çš„å¤‡ä»½æ–‡ä»¶ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰å¤‡ä»½
ls -lh cookies/Cookies.backup.*

# åˆ é™¤æ—§å¤‡ä»½ï¼ˆä¿ç•™æœ€è¿‘ 3 ä¸ªï¼‰
ls -t cookies/Cookies.backup.* | tail -n +4 | xargs rm -f
```

---

## ğŸ”’ å®‰å…¨æç¤º

1. **ä¸è¦æäº¤åˆ° Git**
   - `cookies/` ç›®å½•å·²åœ¨ `.gitignore` ä¸­
   - åŒ…å«æ‚¨çš„ç™»å½•ä¿¡æ¯

2. **ä¸è¦åˆ†äº«**
   - Cookies æ–‡ä»¶ç›¸å½“äºæ‚¨çš„ YouTube ç™»å½•å‡­è¯
   - åˆ†äº«ç»™ä»–äººç›¸å½“äºåˆ†äº«è´¦å·å¯†ç 

3. **å®šæœŸæ›´æ–°**
   - å»ºè®®æ¯æœˆæ›´æ–°ä¸€æ¬¡
   - å‡ºç°è®¤è¯é”™è¯¯æ—¶ç«‹å³æ›´æ–°

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- ğŸ“– [COOKIES_å¿«é€Ÿæ›´æ–°.md](./COOKIES_å¿«é€Ÿæ›´æ–°.md) - å¿«é€Ÿä¸Šæ‰‹æŒ‡å—
- ğŸ“– [COOKIES_é—®é¢˜è§£å†³.md](./COOKIES_é—®é¢˜è§£å†³.md) - è¯¦ç»†é—®é¢˜æ’æŸ¥
- ğŸ“– [UPDATE_COOKIES_GUIDE.md](./UPDATE_COOKIES_GUIDE.md) - è‹±æ–‡å®Œæ•´æŒ‡å—
- ğŸ“– [cookies/README.md](./cookies/README.md) - Cookies ç›®å½•è¯´æ˜

---

## âš¡ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# æµ‹è¯• cookies
./scripts/test_cookies.sh

# æ›´æ–° cookies
./scripts/update_cookies.sh

# æ£€æŸ¥æ–‡ä»¶æ ¼å¼
head -1 cookies/Cookies

# æŸ¥çœ‹ cookie æ•°é‡
grep -v '^#' cookies/Cookies | grep -v '^$' | wc -l

# æŸ¥çœ‹æ–‡ä»¶ä¿®æ”¹æ—¶é—´
ls -lh cookies/Cookies

# æ‰‹åŠ¨æµ‹è¯•ä¸‹è½½
docker exec youtube-dl-api yt-dlp \
  --cookies /app/cookies/Cookies \
  --proxy http://host.docker.internal:7890 \
  --get-title \
  "https://www.youtube.com/watch?v=VIDEO_ID"

# é‡å¯æœåŠ¡
docker-compose restart youtube-dl-api

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs -f youtube-dl-api
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å®šæœŸç»´æŠ¤**
   - æ¯æœˆè¿è¡Œä¸€æ¬¡ `test_cookies.sh`
   - å¿…è¦æ—¶è¿è¡Œ `update_cookies.sh`

2. **å‡ºç°é”™è¯¯æ—¶**
   - å…ˆè¿è¡Œ `test_cookies.sh` è¯Šæ–­
   - å¦‚æœ cookies å¤±æ•ˆï¼Œè¿è¡Œ `update_cookies.sh`
   - å¦‚æœæ˜¯ 429 é”™è¯¯ï¼Œç­‰å¾… 15-30 åˆ†é’Ÿ

3. **å¤‡ä»½ç®¡ç†**
   - ä¿ç•™æœ€è¿‘ 3-5 ä¸ªå¤‡ä»½å³å¯
   - å®šæœŸæ¸…ç†æ—§å¤‡ä»½èŠ‚çœç©ºé—´

4. **æµè§ˆå™¨ç™»å½•**
   - ä¿æŒæµè§ˆå™¨ä¸­ YouTube ç™»å½•çŠ¶æ€
   - å®šæœŸè®¿é—® YouTube ç¡®ä¿è´¦æˆ·æ´»è·ƒ

