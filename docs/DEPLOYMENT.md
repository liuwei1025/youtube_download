# Railway éƒ¨ç½²æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•å°† YouTube ä¸‹è½½å™¨éƒ¨ç½²åˆ° Railway.comã€‚

## ğŸ“‹ å‡†å¤‡å·¥ä½œ

### 1. æ³¨å†Œ Railway è´¦å·
- è®¿é—® [Railway.com](https://railway.com/)
- ä½¿ç”¨ GitHub è´¦å·ç™»å½•

### 2. å‡†å¤‡ä»£ç ä»“åº“
ç¡®ä¿ä½ çš„ä»£ç å·²æ¨é€åˆ° GitHub ä»“åº“ã€‚

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ–¹å¼ä¸€ï¼šé€šè¿‡ Railway Dashboard éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. **åˆ›å»ºæ–°é¡¹ç›®**
   - ç™»å½• Railway Dashboard
   - ç‚¹å‡» "New Project"
   - é€‰æ‹© "Deploy from GitHub repo"

2. **é€‰æ‹©ä»“åº“**
   - æˆæƒ Railway è®¿é—®ä½ çš„ GitHub
   - é€‰æ‹© `youtube_download` ä»“åº“

3. **é…ç½®æœåŠ¡**
   - Railway ä¼šè‡ªåŠ¨æ£€æµ‹ `Dockerfile`
   - ç­‰å¾…æ„å»ºå’Œéƒ¨ç½²å®Œæˆï¼ˆçº¦ 2-5 åˆ†é’Ÿï¼‰

4. **é…ç½®ç¯å¢ƒå˜é‡**ï¼ˆå¯é€‰ï¼‰
   ```
   PORT=8000
   DOWNLOADS_DIR=/tmp/downloads
   HTTP_PROXY=ä½ çš„ä»£ç†åœ°å€ï¼ˆå¦‚éœ€è¦ï¼‰
   HTTPS_PROXY=ä½ çš„ä»£ç†åœ°å€ï¼ˆå¦‚éœ€è¦ï¼‰
   ```

5. **ç”Ÿæˆå…¬å¼€åŸŸå**
   - åœ¨æœåŠ¡è®¾ç½®ä¸­ç‚¹å‡» "Generate Domain"
   - è®°å½•ç”Ÿæˆçš„åŸŸåï¼Œå¦‚ `your-app.up.railway.app`

### æ–¹å¼äºŒï¼šä½¿ç”¨ Railway CLI

```bash
# å®‰è£… Railway CLI
npm install -g @railway/cli

# ç™»å½•
railway login

# åˆå§‹åŒ–é¡¹ç›®
railway init

# éƒ¨ç½²
railway up

# æŸ¥çœ‹æ—¥å¿—
railway logs
```

## ğŸ“¡ API ä½¿ç”¨

éƒ¨ç½²å®Œæˆåï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹ç«¯ç‚¹ä½¿ç”¨æœåŠ¡ï¼š

### 1. æŸ¥çœ‹ API æ–‡æ¡£
```
https://your-app.up.railway.app/docs
```

### 2. å¥åº·æ£€æŸ¥
```bash
curl https://your-app.up.railway.app/health
```

### 3. åˆ›å»ºä¸‹è½½ä»»åŠ¡
```bash
curl -X POST "https://your-app.up.railway.app/download" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
    "start_time": "1:00",
    "end_time": "2:00",
    "download_video": true,
    "download_audio": true,
    "download_subtitles": false
  }'
```

å“åº”ç¤ºä¾‹ï¼š
```json
{
  "task_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "status": "pending",
  "message": "ä»»åŠ¡å·²åˆ›å»ºï¼Œæ­£åœ¨å¤„ç†ä¸­",
  "created_at": "2025-10-07T12:34:56.789012"
}
```

### 4. æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
```bash
curl "https://your-app.up.railway.app/tasks/a1b2c3d4-e5f6-7890-abcd-ef1234567890"
```

å“åº”ç¤ºä¾‹ï¼š
```json
{
  "task_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "status": "completed",
  "url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
  "video_id": "dQw4w9WgXcQ",
  "created_at": "2025-10-07T12:34:56.789012",
  "completed_at": "2025-10-07T12:35:23.456789",
  "files": {
    "video": "segment_1_00-2_00.mp4",
    "audio": "audio_1_00-2_00.mp3"
  }
}
```

### 5. ä¸‹è½½æ–‡ä»¶
```bash
# ä¸‹è½½è§†é¢‘
curl -O "https://your-app.up.railway.app/tasks/a1b2c3d4-e5f6-7890-abcd-ef1234567890/files/video"

# ä¸‹è½½éŸ³é¢‘
curl -O "https://your-app.up.railway.app/tasks/a1b2c3d4-e5f6-7890-abcd-ef1234567890/files/audio"
```

### 6. æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡
```bash
curl "https://your-app.up.railway.app/tasks"

# åªæŸ¥çœ‹å·²å®Œæˆçš„ä»»åŠ¡
curl "https://your-app.up.railway.app/tasks?status=completed"
```

## ğŸ”§ ç¯å¢ƒå˜é‡é…ç½®

åœ¨ Railway Dashboard ä¸­å¯ä»¥é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `PORT` | æœåŠ¡ç«¯å£ | `8000` |
| `DOWNLOADS_DIR` | ä¸‹è½½ç›®å½• | `/tmp/downloads` |
| `HTTP_PROXY` | HTTP ä»£ç† | æ—  |
| `HTTPS_PROXY` | HTTPS ä»£ç† | æ—  |

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### 1. ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿ
- Railway ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼ˆephemeral storageï¼‰
- æœåŠ¡é‡å¯åæ–‡ä»¶ä¼šä¸¢å¤±
- å»ºè®®åŠæ—¶ä¸‹è½½å®Œæˆçš„æ–‡ä»¶

### 2. èµ„æºé™åˆ¶
- Railway å…è´¹å¥—é¤æœ‰èµ„æºé™åˆ¶
- æ³¨æ„ç›‘æ§å†…å­˜å’Œ CPU ä½¿ç”¨
- å¤§æ–‡ä»¶ä¸‹è½½å¯èƒ½éœ€è¦å‡çº§å¥—é¤

### 3. ä»£ç†é…ç½®
- å¦‚æœéœ€è¦è®¿é—®è¢«é™åˆ¶çš„å†…å®¹ï¼Œé…ç½®ä»£ç†
- å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–åœ¨è¯·æ±‚ä¸­æŒ‡å®š

### 4. è¶…æ—¶è®¾ç½®
- é•¿æ—¶é—´ä¸‹è½½å¯èƒ½è§¦å‘è¶…æ—¶
- å»ºè®®ä¸‹è½½è¾ƒçŸ­çš„è§†é¢‘ç‰‡æ®µï¼ˆ<5åˆ†é’Ÿï¼‰

### 5. å¹¶å‘é™åˆ¶
- é¿å…åŒæ—¶åˆ›å»ºå¤§é‡ä¸‹è½½ä»»åŠ¡
- å»ºè®®æ§åˆ¶å¹¶å‘æ•°é‡

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹æ—¥å¿—
åœ¨ Railway Dashboard ä¸­ï¼š
1. è¿›å…¥ä½ çš„é¡¹ç›®
2. é€‰æ‹©æœåŠ¡
3. ç‚¹å‡» "Logs" æ ‡ç­¾

### ç›‘æ§æŒ‡æ ‡
- CPU ä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨ç‡
- ç½‘ç»œæµé‡
- è¯·æ±‚æ•°é‡

## ğŸ› æ•…éšœæ’é™¤

### 1. æœåŠ¡æ— æ³•å¯åŠ¨
- æ£€æŸ¥æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
- ç¡®è®¤ `ffmpeg` å’Œ `yt-dlp` æ­£å¸¸å®‰è£…
- éªŒè¯ Dockerfile æ„å»ºæˆåŠŸ

### 2. ä¸‹è½½å¤±è´¥
- æ£€æŸ¥è§†é¢‘ URL æ˜¯å¦æœ‰æ•ˆ
- ç¡®è®¤ä»£ç†é…ç½®æ­£ç¡®ï¼ˆå¦‚éœ€è¦ï¼‰
- æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€ä¸­çš„é”™è¯¯ä¿¡æ¯

### 3. æ–‡ä»¶ä¸‹è½½å¤±è´¥
- ç¡®è®¤ä»»åŠ¡çŠ¶æ€ä¸º `completed`
- æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- éªŒè¯æ–‡ä»¶è·¯å¾„æ­£ç¡®

### 4. å†…å­˜ä¸è¶³
- é™ä½è§†é¢‘è´¨é‡å‚æ•°
- å‡å°‘å¹¶å‘ä»»åŠ¡æ•°
- è€ƒè™‘å‡çº§ Railway å¥—é¤

## ğŸ” å®‰å…¨å»ºè®®

1. **API è®¿é—®æ§åˆ¶**
   - ç”Ÿäº§ç¯å¢ƒå»ºè®®æ·»åŠ èº«ä»½éªŒè¯
   - å¯ä»¥ä½¿ç”¨ API Key æˆ– JWT Token

2. **é€Ÿç‡é™åˆ¶**
   - å»ºè®®æ·»åŠ é€Ÿç‡é™åˆ¶é˜²æ­¢æ»¥ç”¨
   - å¯ä»¥ä½¿ç”¨ `slowapi` åº“

3. **è¾“å…¥éªŒè¯**
   - å·²å†…ç½®åŸºæœ¬éªŒè¯
   - æ ¹æ®éœ€è¦æ·»åŠ é¢å¤–çš„å®‰å…¨æ£€æŸ¥

## ğŸ’° æˆæœ¬ä¼°ç®—

### Railway å®šä»·ï¼ˆæˆªè‡³ 2025 å¹´ï¼‰
- **Hobby Plan**: $5/æœˆ
  - 500 å°æ—¶æ‰§è¡Œæ—¶é—´
  - é€‚åˆè½»åº¦ä½¿ç”¨

- **Pro Plan**: æŒ‰ä½¿ç”¨é‡è®¡è´¹
  - æ›´é«˜çš„èµ„æºé…é¢
  - æ›´å¥½çš„æ€§èƒ½

å»ºè®®å…ˆä½¿ç”¨ Hobby Plan æµ‹è¯•ï¼Œæ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µå†³å®šæ˜¯å¦å‡çº§ã€‚

## ğŸ“š ç›¸å…³èµ„æº

- [Railway å®˜æ–¹æ–‡æ¡£](https://docs.railway.app/)
- [FastAPI æ–‡æ¡£](https://fastapi.tiangolo.com/)
- [yt-dlp æ–‡æ¡£](https://github.com/yt-dlp/yt-dlp)
- [FFmpeg æ–‡æ¡£](https://ffmpeg.org/documentation.html)

## ğŸ†˜ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹æœ¬é¡¹ç›®çš„ GitHub Issues
2. è®¿é—® Railway Community è®ºå›
3. æŸ¥çœ‹ FastAPI å’Œ yt-dlp çš„æ–‡æ¡£

## ğŸ“ æ›´æ–°æ—¥å¿—

- v2.0.0 (2025-10-07): åˆå§‹ Railway éƒ¨ç½²ç‰ˆæœ¬
  - æ·»åŠ  FastAPI HTTP æœåŠ¡
  - æ”¯æŒå¼‚æ­¥ä»»åŠ¡å¤„ç†
  - æ·»åŠ å®Œæ•´çš„ API æ–‡æ¡£
